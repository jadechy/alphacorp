{% extends 'base.html.twig' %}

{% block title %}
	{{event.title}}
{% endblock %}

{% block body %}
	<section class="flex gap-10 justify-start">

		<img src={{ asset('img/1.png') }} alt="Event Image" class="w-80 object-cover "/>
		<div class="w-full flex flex-col gap-5">
			<div class="flex items-center space-x-6">
				{% if event.author.id != app.user.id %}
					{% if event.isInFuture() %}
						<div class="w-full bg-green-700/80 rounded-lg ">
							<p class="p-4">Cet évènement n'a pas encore commencé, vous pouvez encore y participer.
							</p>
						</div>
					{% elseif event.isOngoing() %}
						<div class="w-full bg-orange-700/80 rounded-lg ">
							<p class="p-4">Cet évènement est en cours.</p>
						</div>
					{% elseif event.isFinished() %}
						<div class="w-full bg-red-700/80 rounded-lg ">
							<p class="p-4">Cet évènement est fini.</p>
						</div>
					{% endif %}
				{% else %}
					{% if event.isInFuture() %}
						<span class="py-1.5 px-2.5 bg-green-700/80 rounded-full flex w-20 justify-center items-center gap-1">
							<p class="font-medium text-xs">Ouvert</p>
						</span>
					{% elseif event.isFinished() %}
						<span class="py-1.5 px-2.5 bg-red-700/80 rounded-full flex w-20 justify-center items-center gap-1">
							<p class="font-medium text-xs">Fermé</p>
						</span>
					{% elseif event.isOngoing() %}
						<span class="py-1.5 px-2.5 bg-orange-700/80 rounded-full flex w-20 justify-center items-center gap-1">
							<p class="font-medium text-xs">En cours</p>
						</span>
					{% endif %}
				{% endif %}
			</div>

			<div class="text-neutral-400">
				<p>{{event.location}}</p>
				<p>
					{{ event.startAt|format_datetime('short', 'none', locale: 'fr') }}
					-
					{{ event.endAt|format_datetime('short', 'none', locale: 'fr') }}</p>
			</div>
			<p>{{event.longDescription}}</p>
			<p class="italic">-
				{{ event.participants|length }}
				participants à cet évènement
			</p>
			{% if event.author != app.user and 'ROLE_ADMIN' not in app.user.roles and event.isInFuture() %}
				{% if isParticipating %}
					<a href="{{ path('unparticipate_event', { id: event.id }) }}">
						<button type="submit" class="btn-secondary">
							Ne plus participer
						</button>
					</a>
				{% else %}
					<a href="{{ path('participate_event', { id: event.id }) }}">
						<button type="submit" class="btn">
							{{ button_label|default('Participer') }}
						</button>
					</a>
				{% endif %}
			{% endif %}
			<div>
				{% if event.author == app.user or 'ROLE_ADMIN' in app.user.roles %}
					{% for participant in event.participants %}
						<p>{{participant.username}}</p>
					{% endfor %}

					{{ include('event/_delete_form.html.twig') }}
				{% endif %}
			</div>

			<p class="border-t mt-2 pt-2">
				Auteur :
				{{event.author.username}}
			</p>
		</div>


	</section>
{% endblock %}
